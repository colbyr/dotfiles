#!/bin/sh

opts=""
while [[ "$1" =~ ^- ]]; do
  opts="$opts $1"
  shift
done

if [ $# -eq 1 ]; then
  git --no-pager grep $opts $1
  exit
fi

result=$(git --no-pager grep -l $1)
shift

while [ $# -gt 1 ]; do
  result=$(echo $result | xargs git --no-pager grep -l $1)
  shift
done

echo $result | xargs git --no-pager grep $opts $1 

